This tab is designed for functional analysis, a deeper dive to reveal the factors differentiating two sample groups. It is subdivided into three subtabs, “Functional comparison” to set up the analyses, and two visualization tabs to plot the results: “Enrichment” and “Over-representation”. The functional comparison tab is divided into multiple sections to prepare the input data and the parameters for the analyses. The sample selection lets the user choose the appropriate data table and the two sample groups to compare. The feature selection section lets the user choose which features will be kept for the subsequent functional analysis. This can be done either with a statistical in conjunction with p-value and fold change thresholds; or using a custom user selection via the feature annotation table, which includes groups exported from other plots, like the volcano plot and the feature correlation. The last two sections are dedicated to the parameters for enrichment (EA) and overrepresentation (ORA) analyses, notably selecting the “Feature sets” to be used. Feature sets are groups of features sharing a role, like the Gene Ontology “Biological Processes”, “Molecular Functions” and “Cellular Components”, which are automatically available for non-small molecule omics. Alternatively, the feature sets can be supplied in the feature annotation table. Since each feature can be associated with multiple feature sets, these can be separated by a pipe (“|”) character.  

## Enrichment analysis.  

Computational method designed to determine whether feature sets show statistically significant, concordant differences between two sample groups. It is based on the original Geneset Enrichment Analysis (GSEA) but applied to any omics using appropriate feature sets. The algorithm starts by ranking all features in the dataset based on their differential expression between the two sample groups, creating a ranked list. An Enrichment Score (ES) is then calculated for each predefined feature set, which reflects the degree to which features from that set are represented at the extremes of the ranked feature list. This is achieved by walking down the ranked list and increasing a running-sum statistic when a feature in the feature set is encountered and decreasing it when it is not. The ES is the maximum deviation from zero encountered in walking the list, corresponding to a weighted Kolmogorov-Smirnov-like statistic. A positive ES indicates a feature set enrichment at the top of the ranked list while a negative ES indicates a feature set enrichment at the bottom of the ranked list. Subsequently, a permutation test is applied to estimate the significance of the ES and derive a p-value, indicating the likelihood that the observed enrichment is due to chance. The permutations are then used to calculate the Normalized Enrichment Score (NES) to account for differing set sizes. By applying a feature set p-value threshold, the enrichment analysis can identify sets that are significantly associated with one sample group or the other. Within these sets, some features contribute more than others to the enrichment score: the core enrichment – or leading-edge subset – are features that appear in the ranked list at or before the point where the running sum reaches its maximum deviation from zero. 

## Over-representation analysis (hypergeometric test / fisher exact test).  

Over-representation Analysis (ORA) is a statistical method used to identify if a feature set is represented more frequently in a list of pre-selected features of interest than would be expected by random chance. These pre-selected features of interest are set apart from the other features either by using a statistical test along with p-value and fold change thresholds; or selected manually by the user via the feature annotations table. A hypergeometric test (or Fisher’s exact test) is then applied to assess the probability (p-value) that the observed frequency of a specific feature set within the list occurs more than would be expected by chance, given the distribution of annotations in the universe of features (i.e. the complete list of features). Sets with a low p-value are significantly over-represented in the list of features of interest, implying they are relevant in the studied sample groups.  

## Functional analysis plots.  

Enrichment and over-representation analysis use similar plots that rely on the same metrics, highlighting the top feature sets and features that differentiate the compared sample groups.  

**Dot Plot**: This plot displays the most significant feature sets resulting from the analysis. They are represented on the y-axis of the bubble plot, against their associated feature ratio on the x-axis. Each bubble – or set – is colored based on their p-value and sized proportional to their feature count. For enrichment analysis, the plot differentiates between suppressed and activated sets using enrichment scores, highlighting the sets associated with one sample group or the other. This visualization aids in identifying biologically significant feature sets that contribute to the observed differences between the two groups under comparison.  

**Bar Plot**: This plot illustrates the top feature sets identified from an overrepresentation analysis, similar to the previously described dot plot. The y-axis lists the feature sets, while the x-axis shows the feature ratios. Each bar is colored according to the p-value of the set it represents, showcasing a clear visual comparison of the statistical significance across different feature sets.  

**Ridge Plot**: This ridge plot provides a multi-layered visualization of the top feature sets identified in an enrichment analysis, with each set plotted along the y-axis against the Log2(fold change) of its associated features on the x-axis. The distribution of features within a set is represented by a density curve along the x-axis, creating a series of vertically stacked ridges. Each ridge is color-coded according to the p-value of its corresponding feature set. Horizontally, the plot illustrates the spread of features from one extreme to the other, indicating their predominance in one of the sample groups. Vertically, the plot allows for comparison of these feature distributions across different sets.  

**CNET Plot**: This network visualization represents feature sets and their associated features as nodes, connected by edges that link features to their respective feature sets. Annotations for both features and sets can be mapped onto the nodes to provide additional information. The CNET plot provides a way to visualize and interpret the complex relationships between features and their feature sets. By displaying Log2(fold change) values on the feature nodes, the plot facilitates the observation of potential differential expressions among feature sets. The plot not only shows which feature sets are influenced by the current analysis but also highlights the associated features. Since these features may belong to multiple sets, the plot often reveals clusters of feature sets, indicating broader, more complex phenomena that aggregate the effects of individual sets.  

**eMap Plot**: The enrichment map (eMap) plot is a streamlined alternative to the CNET plot, specifically designed to handle large numbers of feature sets without becoming cluttered. Unlike the CNET plot, the eMap plot omits feature nodes, reducing complexity and avoiding the creation of unreadable "hairball" networks. Instead, it creates set-to-set edges that reflect the number of shared features relative to the total associated features, quantified by Jaccard’s similarity score (default) to indicate connection strength between two feature sets. The network can be further simplified by applying a similarity score threshold to produce more manageable feature set clusters. Node sizes are scaled based on the feature count of each set, while node coloring reflects p-values, and edge thickness is proportional to the similarity score. This layout allows users to discern larger biological mechanisms coalescing smaller feature sets, offering insights on a bigger scale than what is provided by the CNET plot.  
